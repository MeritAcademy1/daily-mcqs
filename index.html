<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Merit Academy MCQ</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #f4f8ff;
}

header {
  background: #0b3c6d;
  color: white;
  padding: 14px;
  font-size: 22px;
  font-weight: bold;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.container {
  max-width: 600px;
  margin: auto;
  padding: 20px;
  text-align: center;
}

.title {
  font-size: 40px;
  color: #0b3c6d;
  font-weight: bold;
}

.subtitle {
  font-size: 18px;
  color: #0b3c6d;
  margin-bottom: 30px;
}

input {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

button {
  margin-top: 20px;
  padding: 12px 25px;
  font-size: 16px;
  background: #0b3c6d;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.option {
  background: #eee;
  padding: 14px;
  margin: 10px 0;
  border-radius: 8px;
  cursor: pointer;
}

.option:hover { background: #dde8ff; }

.correct { background: #b6f5c3 !important; }
.wrong { background: #f7b2b2 !important; }

.hidden { display: none; }

#timer {
  font-weight: bold;
  color: red;
  margin-bottom: 10px;
}

textarea {
  width: 100%;
  height: 320px;
  font-size: 14px;
}
</style>
</head>

<body>

<header>
  Merit Academy
  <span style="font-size:14px; cursor:pointer;" onclick="openAdmin()">Admin</span>
</header>

<div class="container">

<!-- WELCOME PAGE -->
<div id="startPage">
  <div class="title">MERIT ACADEMY</div>
  <div class="subtitle">~ CTP Falak Meer</div>
  <input id="studentName" placeholder="Enter your name">
  <button onclick="startTest()">Start Test</button>
</div>

<!-- QUIZ PAGE -->
<div id="quizPage" class="hidden">
  <div id="timer"></div>
  <h3 id="question"></h3>
  <div id="options"></div>
  <p id="explanation"></p>
  <button id="nextBtn" class="hidden" onclick="nextQuestion()">Next Question</button>
</div>

<!-- RESULT PAGE -->
<div id="resultPage" class="hidden">
  <h2>Today's Performance</h2>
  <p id="finalName"></p>
  <p id="finalScore"></p>
  <p id="finalAccuracy"></p>
</div>

<!-- ADMIN PAGE -->
<div id="adminPage" class="hidden">
  <h2>Admin Panel</h2>
  <p>Edit exactly 5 questions (JSON format)</p>
  <textarea id="adminEditor"></textarea>
  <button onclick="saveQuestions()">Save Questions</button>
</div>

</div>

<script>
const ADMIN_PASSWORD = "FalakPardiwala@13";

/* DEFAULT QUESTIONS */
const defaultQuestions = [
  {
    question: "What is the capital of India?",
    options: ["Mumbai", "Delhi", "Kolkata", "Chennai"],
    correct: 1,
    explanation: "Delhi is the capital of India."
  },
  {
    question: "2 + 2 = ?",
    options: ["3", "4", "5", "6"],
    correct: 1,
    explanation: "2 + 2 equals 4."
  },
  {
    question: "Which planet is the Red Planet?",
    options: ["Earth", "Mars", "Venus", "Jupiter"],
    correct: 1,
    explanation: "Mars is called the Red Planet."
  },
  {
    question: "Who drafted the Indian Constitution?",
    options: ["Nehru", "Gandhi", "Ambedkar", "Patel"],
    correct: 2,
    explanation: "Dr. B. R. Ambedkar drafted it."
  },
  {
    question: "Largest ocean in the world?",
    options: ["Indian", "Atlantic", "Pacific", "Arctic"],
    correct: 2,
    explanation: "Pacific Ocean is the largest."
  }
];

let questions = JSON.parse(localStorage.getItem("questions")) || defaultQuestions;

let index = 0, correct = 0, wrong = 0;
let timeLeft = 90, timer;
let student = "";

/* STUDENT FLOW */
function startTest() {
  student = document.getElementById("studentName").value.trim();
  if (!student) return alert("Please enter your name");

  document.getElementById("startPage").classList.add("hidden");
  document.getElementById("quizPage").classList.remove("hidden");
  loadQuestion();
}

function loadQuestion() {
  clearInterval(timer);
  timeLeft = 90;
  document.getElementById("timer").textContent = `Time Left: ${timeLeft}s`;
  document.getElementById("nextBtn").classList.add("hidden");
  document.getElementById("explanation").textContent = "";

  const q = questions[index];
  document.getElementById("question").textContent = `Q${index + 1}. ${q.question}`;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt, i) => {
    const div = document.createElement("div");
    div.className = "option";
    div.textContent = opt;
    div.onclick = () => selectAnswer(div, i);
    optionsDiv.appendChild(div);
  });

  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("timer").textContent = `Time Left: ${timeLeft}s`;
    if (timeLeft === 0) {
      clearInterval(timer);
      wrong++;
      showCorrect();
    }
  }, 1000);
}

function selectAnswer(el, i) {
  clearInterval(timer);
  const q = questions[index];
  const opts = document.querySelectorAll(".option");
  opts.forEach(o => o.onclick = null);

  if (i === q.correct) {
    el.classList.add("correct");
    correct++;
  } else {
    el.classList.add("wrong");
    opts[q.correct].classList.add("correct");
    wrong++;
  }

  document.getElementById("explanation").textContent = q.explanation;
  document.getElementById("nextBtn").classList.remove("hidden");
}

function showCorrect() {
  const q = questions[index];
  document.querySelectorAll(".option")[q.correct].classList.add("correct");
  document.getElementById("explanation").textContent = q.explanation;
  document.getElementById("nextBtn").classList.remove("hidden");
}

function nextQuestion() {
  index++;
  if (index < questions.length) loadQuestion();
  else showResult();
}

function showResult() {
  document.getElementById("quizPage").classList.add("hidden");
  document.getElementById("resultPage").classList.remove("hidden");
  document.getElementById("finalName").textContent = `Name: ${student}`;
  document.getElementById("finalScore").textContent =
    `Correct: ${correct} | Incorrect: ${wrong}`;
  document.getElementById("finalAccuracy").textContent =
    `Accuracy: ${Math.round((correct / questions.length) * 100)}%`;
}

/* ADMIN FLOW */
function openAdmin() {
  const pass = prompt("Enter admin password");
  if (pass !== ADMIN_PASSWORD) return alert("Wrong password");

  document.getElementById("startPage").classList.add("hidden");
  document.getElementById("quizPage").classList.add("hidden");
  document.getElementById("resultPage").classList.add("hidden");
  document.getElementById("adminPage").classList.remove("hidden");

  document.getElementById("adminEditor").value =
    JSON.stringify(questions, null, 2);
}

function saveQuestions() {
  try {
    const edited = JSON.parse(document.getElementById("adminEditor").value);
    if (!Array.isArray(edited) || edited.length !== 5) {
      alert("Exactly 5 questions required");
      return;
    }
    localStorage.setItem("questions", JSON.stringify(edited));
    alert("Questions saved successfully");
    location.reload();
  } catch {
    alert("Invalid JSON format");
  }
}
</script>

</body>
</html>
